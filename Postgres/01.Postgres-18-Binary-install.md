## PostgreSQL Binary Install: 



### Install Required Dependencies:

```
yum install -y wget curl lsof vim nano nmap screen tree gzip unzip zip tar htop telnet rsync traceroute nc tcpdump git net-tools yum-utils bind-utils parted lvm2 bash-completion 


yum install -y gcc gcc-c++ automake make autoconf libtool cmake readline-devel zlib-devel systemd-devel flex bison libicu-devel    


yum install -y perl-File-Temp perl-FindBin

yum install -y docbook-dtds docbook-style-xsl libxml2

yum install -y xmlto libxml2-devel libxslt-devel
```



### Create Necessary Directories: 

```
mkdir -p /u01/pgsql/18.1
mkdir -p /u01/pgsql/18.1/dbs/data
```


_Create user:_
```
useradd -m postgres
```



### Download PostgreSQL:

```
cd /u01/pgsql/

wget https://ftp.postgresql.org/pub/source/v18.1/postgresql-18.1.tar.gz
```


```
tar -xvf postgresql-18.1.tar.gz
```


```
cd postgresql-18.1
```


```
./configure --version
```


### Build the PostgreSQL:

By default, make install will install all the files in `/usr/local/pgsql/bin` , `/usr/local/pgsql/lib` etc. You can specify an installation prefix other than `/usr/local/pgsql` using `--prefix` , for instance `--prefix=$HOME`.


```
./configure --prefix=/u01/pgsql/18.1 --with-systemd

make world
make install-world
```

Or,

```
make world-bin
make install-world-bin
```


```
ll /u01/pgsql/18.1
```



After installing PostgreSQL from source, you can run `pg_config` to get various information about your PostgreSQL installation:

```
cd /u01/pgsql/18.1/bin
```


```
./pg_config
```


```
chown -R postgres:postgres /u01
```


```
./initdb --version
```




### Initialize postgreSQL: 

- `-D` , --pgdata=DATADIR : location for this database cluster
- `-k` , --data-checksums : use data page checksums
- `-l` , --log=FILENAME : write (or append) server log to FILENAME


_Switch to `postgres` user:_
```
su - postgres 
```


```
cd /u01/pgsql/18.1/bin

./initdb -D /u01/pgsql/18.1/dbs/data
```



### Configure postgreSQL: 

```
vim /u01/pgsql/18.1/dbs/data/postgresql.conf


listen_addresses = '*' 
```


```
vim /u01/pgsql/18.1/dbs/data/pg_hba.conf


# TYPE  DATABASE        USER            ADDRESS                 METHOD

# "local" is for Unix domain socket connections only
local   all             all                                     trust

# IPv4 local connections:
host    all             all             0.0.0.0/0               md5

# IPv6 local connections:
host    all             all             ::1/128                 md5
```



#### Enable Trace Log: 

```
mkdir -p /u01/pgsql/18.1/trace

chown -R postgres:postgres /u01
```


```
vim /u01/pgsql/18.1/dbs/data/postgresql.conf

```




### Create env file: 

```
vim ~/.bash_profile


### For Postgres:
export PGHOME=/u01/pgsql/18.1
export PGDATA=/u01/pgsql/18.1/dbs/data
export PATH=$PGHOME/bin:$PATH
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$PGHOME/lib
```



```
. ~/.bash_profile
```


```
echo $PGHOME
echo $PGDATA
```


### Start PostgreSQL:

```
pg_ctl start -D $PGDATA
```




### Create Tablespace:

_Create a directory on the filesystem:_
```
mkdir -p /u01/pgsql/tablespace/cdmsapp
mkdir -p /u01/pgsql/tablespace/cdmsapp/index

chown -R postgres:postgres /u01
```


_Create the tablespace:_
```
CREATE TABLESPACE tb_cdmsapp
OWNER cdmsapp
LOCATION '/u01/pgsql/tablespace/cdmsapp';
```


```
CREATE TABLESPACE tb_cdmsapp_indx
OWNER cdmsapp
LOCATION '/u01/pgsql/tablespace/cdmsapp/index';
```


_List of all tablespaces:_
```
postgres=# \db
                       List of tablespaces
      Name       |  Owner   |              Location
-----------------+----------+-------------------------------------
 pg_default      | postgres |
 pg_global       | postgres |
 tb_cdmsapp      | cdmsapp  | /u01/pgsql/tablespace/cdmsapp
 tb_cdmsapp_indx | cdmsapp  | /u01/pgsql/tablespace/cdmsapp/index
(4 rows)
```


#### Create Database:

_Create user:_
```
create user cdmsapp with encrypted password 'password';

Or,

CREATE ROLE cdmsapp SUPERUSER LOGIN PASSWORD 'password';
```



_Create Database with default tablespace:_
```
CREATE DATABASE "cdmsapp"
WITH
  OWNER = "cdmsapp"
  TEMPLATE = "template1"
  ENCODING = 'UTF8'
  TABLESPACE = "tb_cdmsapp"
  LC_COLLATE = 'en_US.UTF-8'
  LC_CTYPE = 'en_US.UTF-8'
;
```



_Verify connect to `cdmsapp` database:_
```
psql -U cdmsapp -d cdmsapp -h 192.168.10.193
Password for user cdmsapp:
```



_Import from the backup:_
```
psql -U cdmsapp -d cdmsapp -f /home/postgres/cdmsapp.sql
```


